<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Rapport Détaillé - {{ current_month_display }}</title>
    <link rel="stylesheet" href="/static/gestion/css/pdf_styles.css">
    <style>
        .header { text-align: center; margin-bottom: 30px; }
        .owner-info { text-align: left; margin-bottom: 20px; border-bottom: 1px solid #ccc; padding-bottom: 10px; }
        .footer { text-align: center; font-size: 9px; color: #777; position: fixed; bottom: 0; }
    </style>
</head>
<body>
    <div class="header">
        {% if agence.logo %}
            <img src="{{ agence.logo.url }}" alt="Logo Agence" style="max-width: 150px; max-height: 80px; margin-bottom: 10px;">
        {% endif %}
        <h1>Rapport Détaillé des Loyers</h1>
        <h2>{{ current_month_display }}</h2>
        <p>Généré le {{ date_generation|date:"d F Y" }}</p>
    </div>

    <div class="owner-info">
        <h4>Propriétaire : {{ proprietaire.user.get_full_name }}</h4>
        <p>Rapport fourni par l'agence : {{ agence.user.get_full_name }}</p>
    </div>

    <table class="table">
        <thead>
            <tr>
                <th>Locataire</th>
                <th>Unité</th>
                <th>Loyer à Payer</th>
                <th>Loyer Payé</th>
                <th>Reste à Payer</th>
                <th>Date de Paiement</th>
            </tr>
        </thead>
        <tbody>
            {% for detail in monthly_rent_details %}
            <tr>
                <td>{{ detail.locataire }}</td>
                <td>{{ detail.chambre.designation }}</td>
                <td>{{ detail.loyer_a_payer|floatformat:0 }} Frcfa</td>
                <td>{{ detail.loyer_paye|floatformat:0 }} Frcfa</td>
                <td {% if detail.reste_a_payer > 0 %}style="color: red;"{% endif %}>{{ detail.reste_a_payer|floatformat:0 }} Frcfa</td>
                <td>{{ detail.date_paiement|date:"d/m/Y"|default:"--" }}</td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" style="text-align: center;">Aucun détail de loyer à afficher pour ce mois.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>